이 문서는 **WAI-UI 프론트엔드 프로젝트**에서 ChatGPT가 코드를 수정할 때 따라야 하는 규칙을 정의한다.  
핵심은 두 개의 도구를 기준으로 하는 **클립보드 기반 자동 동기화 + 로컬 스냅샷 시스템**이다.

---

## 1. 로컬 환경 개요

### 1.1 경로 구조

- Git 저장소 루트: `C:\wai-ui`
- 프론트엔드 루트: `C:\wai-ui\frontend`
- 주요 도구:
  - `C:\wai-ui\frontend\wai_magic.py`
  - `C:\wai-ui\frontend\tools\wai_local_snapshot.py`

### 1.2 실행 중인 두 개의 감시 스크립트

#### A. `wai_magic.py`

- 위치: `C:\wai-ui\frontend\wai_magic.py`
- 역할:
  - 클립보드를 계속 감시한다.
  - 클립보드에 **``** 가 포함된 코드블럭이 복사되면:
    1. `경로`에 해당하는 파일을 `C:\wai-ui\frontend` 기준으로 저장
    2. Git 자동 `add + commit` 수행
    3. 원격 설정이 되어 있으면 자동 `push` 까지 시도
- 이 스크립트는 **파일 수정 전용**이며, 스냅샷은 다루지 않는다.

#### B. `wai_local_snapshot.py`

- 위치: `C:\wai-ui\frontend\tools\wai_local_snapshot.py`
- 모드:
  1. **감시 모드** (인자 없음):
     - `py tools\wai_local_snapshot.py` 로 실행
     - 클립보드를 계속 감시한다.
     - 클립보드에 **`### [WAI:LOCAL_SNAPSHOT:설명]`** 이 포함된 텍스트가 복사되면:
       - `설명`을 이용해 로컬 스냅샷을 생성
       - Git이 추적하는 프론트엔드 파일들을 `_snapshots/` 아래에 백업
       - 항상 **가장 최근 스냅샷 3개만 유지**하고, 오래된 것은 자동 삭제
  2. **CLI 모드** (인자 있음, _복구 및 확인용 전용_):
     - `py tools\wai_local_snapshot.py list`  
       → 저장된 스냅샷 목록 출력
     - `py tools\wai_local_snapshot.py restore <스냅샷이름>`  
       → 해당 스냅샷으로 파일을 덮어써서 복구
     - `py tools\wai_local_snapshot.py save "설명"`  
       → 수동으로 스냅샷 저장 (자동 시스템 외의 예외 상황용)

- 이 스크립트는 **자동 스냅샷 + 수동 복구**를 담당한다.  
- ChatGPT는 **복구 명령을 직접 실행하지 않는다**. 복구는 사용자가 CLI에서 직접 수행한다.

---

## 2. ChatGPT 출력 규칙

### 2.1 파일 수정: `### [WAI:UPDATE:경로]`

ChatGPT가 **어떤 파일이든 수정/생성**할 때는 반드시 아래 패턴을 사용한다.

- 형식:

    ```text
    ### [WAI:UPDATE:상대경로]
    ...이 파일의 전체 내용...
    ```

- 이 전체를 ChatGPT 응답에서 **단일 코드블럭**으로 감싼다. (언어 표시는 자유)
- `상대경로`는 `C:\wai-ui\frontend` 기준 경로:
  - 예:
    - `index.html`
    - `js/core/app-root.js`
    - `docs/element-specs.js`
    - `tools/wai_local_snapshot.py`
    - `wai_magic.py`
- **전체 파일 내용을 항상 포함**해야 한다.
  - 부분 패치, diff, “중간 생략(…​)” 같은 형태는 사용하지 않는다.
  - 사용자는 이 블럭을 통째로 복사해서 `wai_magic.py` 에 전달한다.
- 한 프롬프트에 여러 파일을 수정할 수 있다. 그 경우 **파일마다 WAI:UPDATE 블럭을 별도로** 제공한다.

#### 예시

- ChatGPT 응답(일부):

    ```text
    ```html
    ### [WAI:UPDATE:index.html]
    <!DOCTYPE html>
    <html lang="ko">
    ...
    </html>
    ```
    ```

    ```text
    ```javascript
    ### [WAI:UPDATE:js/core/app-root.js]
    const { createApp } = Vue;
    ...
    createApp(AppRoot).mount('#app-vue-root');
    ```
    ```

사용자는 각 블럭을 복사하면 `wai_magic.py` 가:

- `frontend/index.html`, `frontend/js/core/app-root.js` 파일을 저장
- 각각에 대해 `git add + commit (+ push)` 까지 수행한다.

---

### 2.2 프롬프트 단위 로컬 스냅샷: `### [WAI:LOCAL_SNAPSHOT:설명]`

**한 프롬프트에서 여러 파일을 수정하는 작업이 끝날 때마다**,  
ChatGPT는 마지막에 **로컬 스냅샷용 블럭 하나**를 추가해야 한다.

- 형식:

    ```text
    ### [WAI:LOCAL_SNAPSHOT:설명문자열]
    (이 아래 내용은 선택적 주석; 시스템은 헤더의 설명만 사용)
    ```

- 이 블럭 또한 ChatGPT 응답에서 **단일 코드블럭** 안에 포함된다.
- `설명문자열`:
  - 사람이 나중에 기억하기 쉬운 형태로 작성 (한글/영문 모두 허용)
  - 권장 패턴:
    - `P23_프리뷰/Dev/Inspector 작업 전`
    - `P24_타임라인 네이밍/스펙 정리 후`
- 사용자는 이 블럭을 통째로 복사하면 된다.
  - `tools/wai_local_snapshot.py` 가 감시 중인 CMD 창에서  
    해당 블럭이 클립보드에 들어온 것을 감지 → 스냅샷 자동 저장.

#### 예시

- ChatGPT 응답 마지막 부분:

    ```text
    ```bash
    ### [WAI:LOCAL_SNAPSHOT:P23_프리뷰/Dev/Inspector 작업 후]
    # 이 프롬프트에서 수정한 파일:
    # - index.html
    # - js/core/app-root.js
    # - docs/element-specs.js
    ```
    ```

위 블럭이 복사되면 `wai_local_snapshot.py` 는:

- `_snapshots/20251211_153210_ab12cd_P23_P23_프리뷰-Dev-Inspector-작업-후/` 같은 폴더를 생성
- Git 추적 파일들을 백업
- `[PROMPT 23 1/3 | yyyy-mm-dd HH:MM:SS] ✨ [로컬 스냅샷 저장] ...` 로그 출력
- 이전 스냅샷이 3개를 넘으면 가장 오래된 것부터 삭제

---

## 3. 프롬프트 하나에 대한 권장 출력 템플릿

ChatGPT는 **큰 작업 단위(여러 파일 수정)** 마다 다음과 같이 출력하는 것이 이상적이다.

1. 수정된 각 파일에 대해 하나씩 `WAI:UPDATE` 블럭
2. 마지막에 한 개의 `WAI:LOCAL_SNAPSHOT` 블럭

예시 구조:

- ChatGPT 응답 전체:

    ```text
    ```html
    ### [WAI:UPDATE:index.html]
    ...index.html 전체 코드...
    ```
    
    ```javascript
    ### [WAI:UPDATE:js/core/app-root.js]
    ...app-root.js 전체 코드...
    ```
    
    ```javascript
    ### [WAI:UPDATE:docs/element-specs.js]
    ...element-specs.js 전체 코드...
    ```
    
    ```bash
    ### [WAI:LOCAL_SNAPSHOT:P23_프리뷰/Dev/Inspector 작업 후]
    # 이 프롬프트에서 반영된 변경:
    # - index.html 레이아웃 및 Dev Tooltip 수정
    # - js/core/app-root.js Dev/Inspector 로직 조정
    # - docs/element-specs.js 스펙 동기화
    ```
    ```

사용자는:

1. 각 `WAI:UPDATE` 블럭을 순서대로 복사 → `wai_magic.py` 가 자동 저장+커밋(+푸시)
2. 마지막에 `WAI:LOCAL_SNAPSHOT` 블럭을 복사 → `wai_local_snapshot.py` 가 자동 스냅샷 저장

---

## 4. 복구는 오직 CLI로만 (ChatGPT는 복구를 실행하지 않음)

ChatGPT는 **복구 명령을 직접 실행하지 않는다.**  
복구는 사용자가 CLI에서만 수행한다.

### 4.1 스냅샷 목록 확인

프론트엔드 루트에서:

```text
cd C:\wai-ui\frontend
py tools\wai_local_snapshot.py list